#!/usr/bin/env bash
# This script configures Nginx to add a custom HTTP header

# Update package list
apt update

# Install Nginx
apt install -y nginx

# Allow Nginx on firewall
ufw allow 'Nginx HTTP'

# Ensure Nginx is listening on port 80
server_block_path="/etc/nginx/sites-available/default"
sed -i 's/listen 80 default_server;/listen 80;/g' "$server_block_path"

# Configure Nginx to add custom HTTP header with the server's hostname
echo 'add_header X-Served-By $HOSTNAME;' | sudo tee -a "$server_block_path" > /dev/null

# Restart Nginx to apply changes
sudo systemctl restart nginx
